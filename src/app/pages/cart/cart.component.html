<section class="h-100  mt-4" style="background-color: black;">
    <div class="container py-5 h-100" *ngIf="cartCount !=0">
      <div class="row d-flex justify-content-center align-items-center h-100">
        <div class="col">
          <div class="card bg-info">
            <div class="card-body p-4">
  
              <div class="row">
  
                <div class="col-lg-7">
                  <!-- <h5 class="mb-3"><a routerLink="" class="text-body"><i
                        class="fas fa-long-arrow-alt-left me-2"></i>Continue shopping</a></h5>
                  <hr> -->
  
                  <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                      <h3 class="mb-1">Shopping cart</h3>
                      <p class="mb-0">You have {{cartCount}} items in your cart</p>
                    </div>
                    <div>
                      <p class="mb-0"><span class="text-muted">Sort by:</span> 
                        <a href="#!" class="text-body">price <i class="fas fa-angle-down mt-1"></i></a></p>
                    </div>
                  </div>
  
                  <div class="card mb-3" *ngFor="let cartitems of cartitems">
                    <div class="card-body">
                      <div class="d-flex justify-content-between">
                        <div class="d-flex flex-row align-items-center">
                          <div>
                            <img
                              src={{cartitems.imageUrl}}
                              class="img-fluid rounded-3" alt="Shopping item" style="width: 95px;">
                          </div>
                          <div class="ms-3">
                            <h6 style="font-size: 14px;">{{cartitems.model}}</h6>
                            <!-- <span style="font-size: 14px;">{{cartitems.color}}</span> -->
                            <h6 style="font-size: 12px;" class="mb-0">{{cartitems.storage}},{{cartitems.color}}</h6>
                            <h6 style="font-size: 12px;" class="mb-0">{{cartitems.color}}</h6>
                            <p class="small mb-0"></p>
                          </div>
                        </div>
                        <div class="d-flex flex-row align-items-center">
                          <div style="width: 50px;">
                            <!-- <h5 class="fw-normal mb-0">{{cartitems.storage}}</h5> -->
                          </div>
                          <div style="width: 80px;">
                            <h5 class="mb-0">₹{{cartitems.price}}</h5>
                          </div>
                          <!-- <div style="width: 80px;">
                            <p class="mb-0 px-3 ">QTY :1</p>
                          </div> -->
                          <button class="btn btn-sm" (click)="remove(cartitems._id)" style="color: #cecece;"><i class="fas fa-trash-alt"></i></button>
                        </div>
                      </div>
                    </div> 
                  </div>
  
                </div>

                 <!-- CARD DETAILS Starts -->
                <div class="col-lg-5" *ngIf="! checkedout">
  
                  <div class="card bg-success text-white rounded-3">
                    <div class="card-body">
                      <div class="d-flex justify-content-between align-items-center mb-4">
                        <h5 class="mb-0">Card details</h5>
                        <img src="https://d2d22nphq0yz8t.cloudfront.net/88e6cc4b-eaa1-4053-af65-563d88ba8b26/https://media.croma.com/image/upload/v1637840166/Croma%20Assets/Categories/Brand%20Logo/apple_white_tnzu0e.png/mxw_2048,f_auto"
                          class="img-fluid rounded-3" style="width: 45px;" alt="Avatar">
                      </div>
  
                      <p class="small mb-2">Card type</p>
                      <a href="#!" type="submit" class="text-white"><i
                          class="fab fa-cc-mastercard fa-2x me-2"></i></a>
                      <a href="#!" type="submit" class="text-white"><i
                          class="fab fa-cc-visa fa-2x me-2"></i></a>
                      <a href="#!" type="submit" class="text-white"><i
                          class="fab fa-cc-amex fa-2x me-2"></i></a>
                      <a href="#!" type="submit" class="text-white"><i class="fab fa-cc-paypal fa-2x"></i></a>
                      <!-- card form -->
                      <form class="mt-4" [formGroup]="fg">
                        <div class="form-outline form-white mb-4">
                          <input type="text" id="typeName" class="form-control form-control-lg" siez="17"
                            placeholder="Cardholder's Name" formControlName="cardholdername" />
                          <label class="form-label" for="typeName">Cardholder's Name</label>
                          <p class="text-info" *ngIf=" fg?.get('cardholdername').touched && fg?.get('cardholdername').errors?.required">
                            Name is required
                          </p>
                        </div>
  
                        <div class="form-outline form-white mb-4">
                          <input type="text" id="typeText" class="form-control form-control-lg" siez="17"
                            placeholder="1234 5678 9012 3457" minlength="19" maxlength="19" formControlName="cardnumber" />
                          <label class="form-label" for="typeText">Card Number</label>
                          <p class="text-info" *ngIf=" fg?.get('cardnumber').touched && fg?.get('cardnumber').errors?.required">
                            Card number is required
                          </p>
                        </div>
  
                        <div class="row mb-4">
                          <div class="col-md-6">
                            <div class="form-outline form-white">
                              <input type="text" id="typeExp" class="form-control form-control-lg"
                                placeholder="MM/YYYY" size="7" id="exp" minlength="7" maxlength="7" formControlName="expiration"/>
                              <label class="form-label" for="typeExp">Expiration</label>
                              <p class="text-info" *ngIf=" fg?.get('expiration').touched && fg?.get('expiration').errors?.required">
                                Expiration is required
                              </p>
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="form-outline form-white">
                              <input type="password" id="typeText" class="form-control form-control-lg"
                                placeholder="&#9679;&#9679;&#9679;" size="1" minlength="3" maxlength="3" formControlName="cvv"/>
                              <label class="form-label" for="typeText">Cvv</label>
                              <p class="text-info" *ngIf=" fg?.get('cvv').touched && fg?.get('cvv').errors?.required">
                                Cvv is required
                              </p>
                            </div>
                          </div>
                        </div>
  
                      </form>
  <!--                    card form end -->

                      <hr class="my-4">
  
                      <div class="d-flex justify-content-between" >
                        <p class="mb-2">Subtotal</p>
                        <p class="mb-2 text-center">₹{{Totalprice}}</p>
                      </div>
  
                      <div class="d-flex justify-content-between">
                        <p class="mb-2">Shipping</p>
                        <p class="mb-2">₹{{Shipping}}</p>
                      </div>
  
                      <div class="d-flex justify-content-between mb-4">
                        <p class="mb-2">Total Payable(Incl. taxes)</p>
                        <p class="mb-2">₹{{Total}}</p>
                      </div>
  
                      <button type="button" routerLink="/cart/success" (click)="cardpayment()" class="btn btn-info btn-block btn-lg">
                        <div class="d-flex justify-content-between">
                          <span class="mx-2">₹{{Total}}</span>
                          <span>Checkout <i class="fas fa-long-arrow-alt-right ms-2"></i></span>
                        </div>
                      </button>

                      <button class="btn btn-info btn-lg mx-3" (click)="back()">Back</button>
  
                    </div>
                  </div>
                </div>
                <!-- CARD DETAILS ENDS -->

                <!-- UPI DETAILS STARTS -->
                <div class="col-lg-5" *ngIf="UPI">
  
                  <div class="card bg-success text-white rounded-3">
                    <div class="card-body">
                      <div class="d-flex justify-content-between align-items-center mb-4">
                        <h5 class="mb-0">UPI details</h5>
                        <img src="https://d2d22nphq0yz8t.cloudfront.net/88e6cc4b-eaa1-4053-af65-563d88ba8b26/https://media.croma.com/image/upload/v1637840166/Croma%20Assets/Categories/Brand%20Logo/apple_white_tnzu0e.png/mxw_2048,f_auto"
                          class="img-fluid rounded-3" style="width: 45px;" alt="Avatar">
                      </div>
              
                      <p class="small mb-2">UPI type</p>
                      <a href="#!" type="submit" class="text-white mx-3">
                          <img style="height: 40px; width: 40px;" src="https://i.pinimg.com/564x/ae/5f/e3/ae5fe3dc423e44c0ddbef5dc64fa356b.jpg" alt="">
                      </a>
                      <a href="#!" type="submit" class="text-white mx-3">
                          <img style="height: 40px; width: 40px;" src="https://i.pinimg.com/564x/cb/42/65/cb42659bb56702c5d6c128ac5b6c3fbe.jpg" alt="">
                      </a>
                      <a href="#!" type="submit" class="text-white mx-3">
                          <img style="height: 40px; width: 40px;" src="https://i.pinimg.com/564x/bd/6b/37/bd6b374b82c389074c7396aaca4d31cd.jpg" alt="">
                      </a>
                      <a href="#!" type="submit" class="text-white mx-3">
                          <img style="height: 40px; width: 40px;" src="https://i.pinimg.com/564x/f7/cf/b9/f7cfb99dc940d107eb180465312a7ee4.jpg" alt="">
                      </a>
              
                      <form [formGroup]="fg">

                        <ul class="mt-3" style="list-style: none;">
                            <li>
                            <input class="form-check-input" type="radio"  name="inlineRadioOptions" id="phonepe"
                                value="UPI" (click)="phonePay()" />
                            <label class="form-check-label mx-3" for="phonepe">Phone Pe</label><br>
                            <div class="d-flex" *ngIf="phonepay">
                                <input type="text" placeholder="Enter Your Upi Id" class="mx-3" formControlName="UpiId"> <button class="btn btn-primary btn-sm" (click)="verifyPhonePayuser()">Submit</button>
                            </div>
                            <p class="text-info" *ngIf="verify" >
                              UPI Id verified Successfully
                            </p>
                            </li>
                    
                            <li>
                            <input class="form-check-input" type="radio"  name="inlineRadioOptions" id="GPay"
                                value="" (click)="googlePay()">
                            <label class="form-check-label mx-3" for="GPay">Google Pay</label><br>
                            <div class="d-flex" *ngIf="googlepay">
                                <input type="text" placeholder="Enter Your Upi Id" class="mx-3" formControlName="UpiId"> <button class="btn btn-primary btn-sm" (click)="verifyGpayuser()">Submit</button>
                            </div>
                            <p class="text-info" *ngIf="verify" >
                              UPI Id verified Successfully
                            </p>
                            </li>
                    
                            <li>
                            <input class="form-check-input"  type="radio" name="inlineRadioOptions" id="Mobikwik"
                                value="" (click)="mobiKwik()"/>
                            <label class="form-check-label mx-3" for="Mobikwik">Mobikwik</label>
                            <div class="d-flex" *ngIf="mobikwik">
                                <input type="text" placeholder="Enter Your Upi Id" class="mx-3" formControlName="UpiId"> <button class="btn btn-primary btn-sm" (click)="verifyMobikwikuser()">Submit</button>
                            </div>
                            <p class="text-info" *ngIf="verify" >
                              UPI Id verified Successfully
                            </p>
                            </li>
                    
                            <li>
                            <input class="form-check-input" type="radio" name="inlineRadioOptions" id="Paytm"
                                value="" (click)="payTm()"/>
                            <label class="form-check-label mx-3" for="Paytm">Paytm</label>
                            <div class="d-flex" *ngIf="paytm">
                                <input type="text" placeholder="Enter Your Upi Id" class="mx-3" formControlName="UpiId"> <button class="btn btn-primary btn-sm" (click)="verifyPaytmuser()">Submit</button> <br>
                            </div>
                            <p class="text-info" *ngIf="verify" >
                              UPI Id verified Successfully
                            </p>
                            </li>
                            
                    
                    
                        </ul>
                      </form>
              
                      <hr class="my-4">
              
                      <div class="d-flex justify-content-between" >
                        <p class="mb-2">Subtotal</p>
                        <p class="mb-2 text-center">{{Totalprice}}</p>
                      </div>
              
                      <div class="d-flex justify-content-between">
                        <p class="mb-2">Shipping</p>
                        <p class="mb-2">{{Shipping}}</p>
                      </div>
              
                      <div class="d-flex justify-content-between mb-4">
                        <p class="mb-2">Total Payable(Incl. taxes)</p>
                        <p class="mb-2">{{Total}}</p>
                      </div>
              
                      <button type="button" routerLink="/cart/success" (click)="upiTransactions()" class="btn btn-info btn-block btn-lg">
                        <div class="d-flex justify-content-between">
                          <span class="mx-2">{{Total}}</span>
                          <span>Checkout <i class="fas fa-long-arrow-alt-right ms-2"></i></span>
                        </div>
                      </button>
              
                      <button class="btn btn-info btn-lg mx-3" (click)="goback()">Back</button>
              
                    </div>
                  </div>
                </div>
              
                <!-- UPI DETAILS Ends -->
  
                <div class="col-lg-5" *ngIf="checkedout && ! UPI" >
  
                  <div class="card bg-success text-white rounded-3">
                    <div class="card-body">
                      <div class="d-flex justify-content-between align-items-center mb-4">
                        <h5 class="mb-0">Order details</h5>
                        <img src="https://d2d22nphq0yz8t.cloudfront.net/88e6cc4b-eaa1-4053-af65-563d88ba8b26/https://media.croma.com/image/upload/v1637840166/Croma%20Assets/Categories/Brand%20Logo/apple_white_tnzu0e.png/mxw_2048,f_auto"
                          class="img-fluid rounded-3" style="width: 45px;" alt="Avatar">
                      </div>
              
                      <!-- <p class="small mb-2">Card type</p>
                      <a href="#!" type="submit" class="text-white"><i
                          class="fab fa-cc-mastercard fa-2x me-2"></i></a>
                      <a href="#!" type="submit" class="text-white"><i
                          class="fab fa-cc-visa fa-2x me-2"></i></a>
                      <a href="#!" type="submit" class="text-white"><i
                          class="fab fa-cc-amex fa-2x me-2"></i></a>
                      <a href="#!" type="submit" class="text-white"><i class="fab fa-cc-paypal fa-2x"></i></a> -->
              
                      <form class="mt-4" [formGroup]="fg">
                        <div class="form-outline form-white mb-4">
                          <input type="text" id="typeName" class="form-control form-control-lg" siez="17"
                            placeholder="Enter Your Name"  formControlName="fullname" />
                          <label class="form-label" for="typeName">Full Name</label>
                          <p class="text-info" *ngIf=" fg?.get('fullname').touched && fg?.get('fullname').errors?.required">
                            Full Name is required
                          </p>
                        </div>
              
                        <div class="form-outline form-white mb-4">
                          <input type="text" id="typeText" class="form-control form-control-lg" siez="17"
                            placeholder="Enter Your Address" minlength="10" maxlength="190" formControlName="address" />
                          <label class="form-label" for="typeText">Address</label>
                          <p class="text-info" *ngIf=" fg?.get('address').touched && fg?.get('address').errors?.required">
                            Address is required
                          </p>
                        </div>

                        <div class="form-outline form-white mb-4">
                          <input type="tel" id="typeText" class="form-control form-control-lg" siez="17"
                          placeholder="+91 1234567899" minlength="10" maxlength="190" formControlName="phone" />
                          <label class="form-label" for="typeText">Contact Number</label>
                          <p class="text-info" *ngIf=" fg?.get('phone').touched && fg?.get('phone').errors?.required">
                            Contact Number is required
                          </p>
                        </div>
              
                        <div class="row mb-4">
                          <div class="col-md-6">
                            <div class="form-outline form-white">
                              <input type="text" id="typeExp" class="form-control form-control-lg"
                                placeholder="Pincode" size="7" id="exp" minlength="6" maxlength="6"  formControlName="pincode" />
                              <label class="form-label" for="typeExp">Pincode</label>
                              <p class="text-info" *ngIf=" fg?.get('pincode').touched && fg?.get('pincode').errors?.required">
                                Pincode is required
                              </p>
                            </div>
                          </div>
                          <div class="col-md-6">
                            <div class="form-outline form-white">
                              <input type="text" id="typeText" class="form-control form-control-lg"
                                placeholder="" size="1" minlength="3" maxlength="30"   formControlName="street" />
                              <label class="form-label" for="typeText">Street/Area</label>
                              <p class="text-info" *ngIf=" fg?.get('street').touched && fg?.get('street').errors?.required">
                                Pincode is required
                              </p>
                            </div>
                          </div>
                        </div>
              
                      </form>
              
                      <hr class="my-4">
              
                      <!-- <div class="d-flex justify-content-between" >
                        <p class="mb-2">Subtotal</p>
                        <p class="mb-2 text-center">₹Totalprice</p>
                      </div>
              
                      <div class="d-flex justify-content-between">
                        <p class="mb-2">Shipping</p>
                        <p class="mb-2">₹Shipping</p>
                      </div>
              
                      <div class="d-flex justify-content-between mb-4">
                        <p class="mb-2">Total(Incl. taxes)</p>
                        <p class="mb-2">₹Total</p>
                      </div> -->
              
                  Payement Method
                  <ul style="list-style: none;">
                      <li>
                      <input class="form-check-input" type="radio" (click)="forprevioustext()"
                      (click)="upiTransaction()" name="inlineRadioOptions" id="upi" value="UPI"/>
                      <label class="form-check-label mx-3" for="upi">UPI</label>
                      </li>
              
                      <li>
                      <input class="form-check-input"  type="radio"  name="inlineRadioOptions" id="card"
                          value="" (click)="forprevioustext()" (click)="checkoutcard()"/>
                      <label class="form-check-label mx-3" for="card">Credit/Debit/ATM Card</label>
                      </li>
              
                      <li>
                      <!-- <input class="form-check-input"  type="radio" name="inlineRadioOptions" id="net"
                          value="" (click)="forprevioustext()"/>
                      <label class="form-check-label mx-3" for="net">Net Banking</label>
                      </li>
              
                      <li>
                      <input class="form-check-input" type="radio" name="inlineRadioOptions" id="emi"
                          value="" (click)="forprevioustext()" />
                      <label class="form-check-label mx-3" for="emi">EMI</label>
                      </li> -->
                      
                      <li>
                      <input class="form-check-input" type="radio" (click)="changebuttontext()" name="inlineRadioOptions" id="cod"
                          value="" />
                      <label class="form-check-label mx-3" for="cod" >Cash On Delivery</label>
                      </li>
              
              
                  </ul>
              
                      <button type="button" class="btn btn-info btn-block btn-lg" *ngIf=" buttontext">
                        <div class="d-flex justify-content-between">
                          <!-- <span class="mx-2">₹Total</span> -->
                          <span #changetext id="changetext"> Proceed To Payment <i class="fas fa-long-arrow-alt-right ms-2"></i></span>
                        </div>
                      </button>

                    <!-- button for upi payment -->
                      <button type="button" (click)="PlaceCodOrder()" class="btn btn-info btn-block btn-lg" routerLink="/cart/success" *ngIf="! buttontext">
                        <div class="d-flex justify-content-between">
                          <span class="mx-2">₹{{Total}}</span>
                          <span #changetext id="changetext"> Place Order <i class="fas fa-long-arrow-alt-right ms-2"></i></span>
                        </div>
                      </button>
              
                    </div>
                  </div>
                </div>
              </div>
  
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

<!-- this is for when cart is empty -->

  <div class="container p-2 " style="margin-top: 80px; border-radius: 50px; background-color: black;" *ngIf="cartCount==0" >
    <div class="card emptycard">
        <h5 class="card-title text-center">My Cart</h5>
    </div>
    <div class="center centerbite mt-4">
        <img src="https://rukminim1.flixcart.com/www/800/800/promos/16/05/2019/d438a32e-765a-4d8b-b4a6-520b560971e8.png?q=90" alt="">
        <h4>Your Cart is empty !</h4>
        <h6>Add item to it now</h6>
        <button class="btn btn-primary" routerLink="">Shop Now</button>
    </div>
  </div>
